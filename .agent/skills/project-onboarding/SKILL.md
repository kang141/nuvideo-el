# Project Onboarding & Navigation Skill

---

name: project-onboarding  
description: 快速建立“项目全景 + 运行链路 + 关键风险”的代码心智模型，帮助你在陌生仓库里迅速掌控方向、定位改动点，并保持文档与代码同步。

---

## 核心目标

- **快速上手**：在最短时间搞清楚“它怎么跑起来、谁在驱动谁”。
- **掌控改动**：改一个功能前先知道会影响哪里、风险点在哪里。
- **持续可读**：让项目越改越清晰（文档/注释/结构逐步变好，而不是越改越乱）。

---

## 触发规则

满足任一条件自动启用：

- 新项目 / 新仓库 / 接手别人代码 / “帮我读一下这个项目”
- 需要定位功能：登录、支付、权限、消息、搜索、上传、埋点、路由、状态管理等
- 需要理解链路：启动流程、请求链路、事件流、任务队列、异步/并发
- 出现不确定性：改动范围不清、依赖关系混乱、模块职责不明、线上风险担忧
- 需要产出：README、架构说明、开发指南、Runbook、变更影响说明

不触发 / 降级：

- 用户明确只要单文件解释，不需要全局视角
- 时间紧只做“最短可运行路径”（MVP 级扫读）

---

## 职责

1. **架构拆解**
   - 用“分层视角”描述：入口层 → 路由/接口层 → 业务层 → 数据层 → 基础设施
   - 标注模块边界、依赖方向、跨层调用点

2. **关键流追踪**
   - 启动链路（Start-up Path）
   - 核心业务链路（Core Use-cases）
   - 数据流 / 状态流（Data & State Flow）
   - 错误与恢复链路（Error/Retry/Fallback）

3. **快速导航**
   - 输入“功能描述”，输出“你该看哪里 + 为什么”
   - 给出“最短阅读路径”：先看 A 再看 B，跳过无关噪音
   - 解释陌生模块：它负责什么、依赖谁、对外暴露什么

4. **风险与改动影响**
   - 标出“高风险区”：边界条件、并发、缓存、鉴权、交易一致性、第三方依赖
   - 给出“改动前检查清单”：测试点、回滚点、监控点

5. **文档同步建议**
   - 每次发现信息缺口：建议补到 README / ADR / runbook
   - 输出可复制的“文档补丁段落”（而不是泛泛建议）

---

## 执行方法（轻量但好用）

### Step 1：找到入口与运行方式（How it boots）

优先从以下“入口锚点”开始（按语言/框架择优）：

- Node/Web：`package.json`（scripts）、`src/main.*`、`index.*`、`server.*`
- React/Next：`pages/` / `app/`、`_app.*`、`middleware.*`
- Vue：`main.ts/js`、`router/`、`store/`
- Backend：`main.go`、`cmd/`、`Program.cs`、`Main.java`
- Rust：`main.rs`、`lib.rs`
- Python：`pyproject.toml`、`manage.py`、`app.py`

输出：**启动路径 + 关键初始化动作**（配置、依赖注入、路由注册、数据库连接、任务调度）。

### Step 2：建立“模块地图”（What are the big pieces）

按“职责”而不是按文件夹名字去归类：

- UI / API / Domain / Data / Infra / Shared
- 对每块给一句话定位：输入是什么、输出是什么、边界在哪里

输出：**一张模块地图（文字版）**，并标注“核心模块”和“可替换模块”。

### Step 3：抓住两条主线（Where value flows）

- **用户价值主线**：一次关键操作从 UI/API 进入后，穿过哪些模块，最后落到哪里
- **数据主线**：数据从哪里来、如何校验、在哪里缓存、怎么落库、谁订阅它

输出：**链路要点 + 关键文件/函数定位列表**。

### Step 4：风险扫描（Where it breaks）

重点看：

- 权限/鉴权边界
- 状态一致性（尤其支付/库存/订单）
- 并发与异步（队列、重试、幂等）
- 缓存与数据源一致性
- 外部依赖（第三方 API、SDK、Webhook）

输出：**Top 风险点（3–7 条）+ 影响范围 + 建议的防护手段**。

### Step 5：给你一条“改动路线”（How to change safely）

- 改动点在哪些文件
- 需要新增/修改哪些测试
- 建议加哪些日志/指标
- 发布与回滚策略（简述）

输出：**可执行的改动路线**。

---

## 输出模板（我会按这个格式给你答案）

### 1) 项目全景（30 秒版）

- 这是一个：<一句话总结>
- 入口/启动：<关键入口文件 + 启动命令>
- 核心模块：<3–6 个模块>
- 关键链路：<1–2 条>

### 2) 模块地图（文字拓扑）

- Module A → Module B → Module C（标注依赖方向）
- 哪些是“核心不可动”，哪些是“可替换/可扩展”

### 3) 你要找的功能：<功能名>

- 推荐阅读路径：A → B → C
- 关键定位：文件/函数/类名（尽量精确）
- 改动影响：会牵扯到哪些模块

### 4) 风险与建议

- 风险点 1：<说明> → 建议：<做法>
- 风险点 2：...

### 5) 文档补丁（可直接贴到 README）

> <一段可复制文本>

---

## 执行准则

- **先跑通，再优化理解**：先拿到“最短可运行路径”，再补全细节。
- **先主线，再支线**：先抓 1–2 条关键链路，不陷入文件海。
- **先边界，再内部**：先明确模块边界和输入输出，再深入实现。
- **结论可验证**：所有推断都用“入口/调用链/依赖关系”落到具体文件上。
- **文档是副产物**：每次分析都顺手产出一段可复用文档。

---
